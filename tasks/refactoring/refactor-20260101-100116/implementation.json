{
  "meta": {
    "title": "Full Codebase Refactor - Terminal Project",
    "created": "2026-01-01",
    "session_id": "refactor-20260101-100116",
    "project_id": "terminal",
    "baseline": {
      "targets": 2,
      "total_complexity": 15.16
    }
  },
  "phases": [
    {
      "id": 1,
      "name": "DRY Consolidation",
      "goal": "Migrate inconsistent hover handlers to use existing useHoverStyle hook",
      "tasks": [
        {
          "id": "1.1",
          "tier": 1,
          "model": "haiku",
          "parallelizable": true,
          "description": "Migrate inline hover handlers in TerminalManagerModal.tsx to useHoverStyle hook",
          "files_affected": [
            "frontend/components/TerminalManagerModal.tsx"
          ],
          "steps": [
            "Add useHoverStyle import if not already present",
            "Create hoverStyle constant using useHoverStyle for 'New Generic Terminal' button (lines 217-224)",
            "Create hoverStyle constant for 'Cancel' button (lines 247-254)",
            "Create hoverStyle constant for SortableProjectRow (lines 301-306)",
            "Replace inline onMouseEnter/onMouseLeave with spread of hoverStyle handlers",
            "Verify: cd frontend && npx tsc --noEmit"
          ],
          "verification": "cd /home/kasadis/terminal/frontend && npx tsc --noEmit",
          "passes": true
        }
      ]
    },
    {
      "id": 2,
      "name": "Utility Extraction",
      "goal": "Extract slot helper functions to shared utility module",
      "tasks": [
        {
          "id": "2.1",
          "tier": 2,
          "model": "sonnet",
          "parallelizable": false,
          "description": "Extract slot helper functions from SplitPane to frontend/lib/utils/slot.ts",
          "files_affected": [
            "frontend/components/TerminalTabs.tsx",
            "frontend/lib/utils/slot.ts"
          ],
          "steps": [
            "Create frontend/lib/utils/slot.ts with getSlotSessionId, getSlotPanelId, getSlotName, getSlotWorkingDir functions",
            "Define TerminalSlot type import from types file",
            "Update SplitPane in TerminalTabs.tsx to import and use utility functions",
            "Remove inline getSessionId, getPanelId, getName, getWorkingDir from SplitPane",
            "Verify: cd frontend && npx tsc --noEmit"
          ],
          "verification": "cd /home/kasadis/terminal/frontend && npx tsc --noEmit",
          "passes": true
        },
        {
          "id": "2.2",
          "tier": 1,
          "model": "haiku",
          "parallelizable": false,
          "description": "Consolidate getProjectSessionId into session.ts utility",
          "files_affected": [
            "frontend/components/TerminalTabs.tsx",
            "frontend/lib/utils/session.ts"
          ],
          "steps": [
            "Add getProjectSessionId function to frontend/lib/utils/session.ts",
            "Export getProjectSessionId from session.ts",
            "Update TerminalTabs.tsx to import getProjectSessionId from session.ts",
            "Remove inline getProjectSessionId definition from TerminalTabs.tsx",
            "Verify: cd frontend && npx tsc --noEmit"
          ],
          "verification": "cd /home/kasadis/terminal/frontend && npx tsc --noEmit",
          "passes": true
        }
      ]
    },
    {
      "id": 3,
      "name": "Component Extraction",
      "goal": "Extract SplitPane sub-component to reduce TerminalTabs.tsx complexity",
      "tasks": [
        {
          "id": "3.1",
          "tier": 2,
          "model": "sonnet",
          "parallelizable": false,
          "description": "Extract SplitPane component from TerminalTabs.tsx",
          "files_affected": [
            "frontend/components/TerminalTabs.tsx",
            "frontend/components/SplitPane.tsx"
          ],
          "steps": [
            "Create frontend/components/SplitPane.tsx with SplitPaneProps interface",
            "Move SplitPane component logic (lines 500-650) to new file",
            "Import slot utilities from frontend/lib/utils/slot.ts",
            "Export SplitPane component",
            "Update TerminalTabs.tsx to import SplitPane from new file",
            "Remove inline SplitPane from TerminalTabs.tsx",
            "Verify: cd frontend && npx tsc --noEmit"
          ],
          "verification": "cd /home/kasadis/terminal/frontend && npx tsc --noEmit",
          "passes": true
        }
      ]
    },
    {
      "id": 4,
      "name": "Performance Optimization",
      "goal": "Batch async operations for better UX",
      "tasks": [
        {
          "id": "4.1",
          "tier": 1,
          "model": "haiku",
          "parallelizable": false,
          "description": "Batch async updates in handleApply for parallel execution",
          "files_affected": [
            "frontend/components/TerminalManagerModal.tsx"
          ],
          "steps": [
            "Identify all async operations in handleApply (settings updates)",
            "Collect update promises in an array instead of sequential awaits",
            "Use Promise.all() to execute updates in parallel",
            "Update onApply callback to handle any errors",
            "Verify: cd frontend && npx tsc --noEmit"
          ],
          "verification": "cd /home/kasadis/terminal/frontend && npx tsc --noEmit",
          "passes": false
        }
      ]
    },
    {
      "id": 5,
      "name": "Final Verification",
      "goal": "Verify all changes work correctly together",
      "tasks": [
        {
          "id": "5.1",
          "tier": 1,
          "model": "haiku",
          "parallelizable": false,
          "description": "Run full frontend verification",
          "files_affected": [],
          "steps": [
            "Run TypeScript type check: cd frontend && npx tsc --noEmit",
            "Run ESLint: cd frontend && npm run lint",
            "Run frontend build: cd frontend && npm run build"
          ],
          "verification": "cd /home/kasadis/terminal/frontend && npm run build",
          "passes": false
        }
      ]
    }
  ]
}
